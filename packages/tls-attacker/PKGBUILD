# This file is part of BlackArch Linux ( https://www.blackarch.org/ ).
# See COPYING for license details.

pkgname=tls-attacker
_pkgname=TLS-Attacker
pkgver=3.4.0
pkgrel=1
pkgdesc='A Java-based framework for analyzing TLS libraries.'
groups=('blackarch' 'blackarch-crypto')
arch=('any')
url='https://github.com/RUB-NDS/TLS-Attacker'
license=('Apache')
depends=('java-environment')
makedepends=('git' 'maven')
source=("https://github.com/RUB-NDS/TLS-Attacker/archive/$pkgver.tar.gz")
sha512sums=('c7499c0950b095a0c19ba71460016ba8920a2d8a925934648b892d5c180c71a2da408e625754b2bc3b3e43af0451a5a096bf638d96daa8d50d81a955cc3754af')

build() {
  cd "$_pkgname-$pkgver"

  mvn package
}

package() {
  _tools="Attacks TLS-Client TLS-Forensics TLS-Mitm TLS-Server TraceTool"

  install -dm 755 "$pkgdir/usr/bin"
  install -dm 755 "$pkgdir/usr/share/$pkgname"

  cp -a * "$pkgdir/usr/share/$pkgname/"

  for t in $_tools ; do
    cat > "$pkgdir/usr/bin/$pkgname-$t" << EOF
#!/bin/sh
cd /usr/share/$pkgname
exec java -jar $t.jar "\$@"
EOF
    chmod +x "$pkgdir/usr/bin/$pkgname-$t"
  done
}


# This file is part of BlackArch Linux ( http://blackarch.org ).
# See COPYING for license details.

pkgname=darkjumper
pkgver=5.8
pkgrel=3
pkgdesc='This tool will try to find every website that host at the same server at your target.'
depends=('perl' 'python2')
url='http://sourceforge.net/projects/darkjumper/'
groups=('blackarch' 'blackarch-webapp')
license=('GPL')
arch=('any')
source=("http://downloads.sourceforge.net/darkjumper/${pkgname}.v${pkgver}.tar.gz")
sha512sums=('91f412cce641831f3797e659b5f8390f984e61c5736503ab1fc0c8fa06abf5b96d6290a70ab46a30be24c0dd194a8ff6634b3775963d23db7d5449d810bb2374')

prepare(){
  cd "$srcdir/darkjumper.v$pkgver"

  sed -i 's|/usr/bin/python|/usr/bin/env python2|' *.py
  sed -i '/file\.write/d' *.py
}

package() {
  cd "$srcdir/darkjumper.v$pkgver"

  install -dm 755 "$pkgdir/usr/share/darkjumper"
  install -dm 755 "$pkgdir/usr/bin"

  cp -a --no-preserve=ownership * "$pkgdir/usr/share/darkjumper"

  chmod -x "$pkgdir/usr/share/darkjumper"/*
  chmod +x "$pkgdir/usr/share/darkjumper"/*.{pl,py}
  rm "$pkgdir/usr/share/darkjumper"/*.pyc

  for i in *.pl *.py ; do
    ln -s "/usr/share/darkjumper/$i" "$pkgdir/usr/bin/$i"
  done
}

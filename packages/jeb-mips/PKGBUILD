# This file is part of BlackArch Linux ( http://blackarch.org ).
# See COPYING for license details.

pkgname=jeb-mips
pkgver=3.0.beta.X
pkgrel=1
pkgdesc='Mips decompiler.'
arch=('any')
groups=('blackarch' 'blackarch-reversing')
url='https://www.pnfsoftware.com/jeb/mips'
license=('custom:unknown')
depends=('java-runtime-common')
source=("https://www.pnfsoftware.com/dl?jebdemomips")
sha512sums=('SKIP')

pkgver() {
  curl 'https://www.pnfsoftware.com/jeb/changelist' | grep 'JEB v' | head -n 1 | sed -e 's/.*JEB v\(.*\)<.*/\1/gi' -e 's/-/./gi'
}

package() {
  install -dm 755 "$pkgdir/opt/$pkgname"
  rm -rf 'dl?jebdemomips'
  cp -a * "$pkgdir/opt/$pkgname"
  mkdir -p "$pkgdir/usr/bin/"
  cat > "$pkgdir/usr/bin/$pkgname" << EOF
#!/bin/sh
cd /opt/$pkgname
exec ./jeb_linux.sh "\${@}"
EOF
  chmod +x "$pkgdir/usr/bin/$pkgname"
}

# This file is part of BlackArch Linux ( https://www.blackarch.org/ ).
# See COPYING for license details.

pkgname=htexploit
_pkgname=HTExploit
pkgver=0.8
pkgrel=1
epoch=1
pkgdesc='A Python script that exploits a weakness in the way that .htaccess files can be configured to protect a web directory with an authentication process.'
arch=('any')
groups=('blackarch' 'blackarch-exploitation')
url='https://www.mkit.com.ar/labs/htexploit/'
license=('GPL-3.0-or-later')
depends=('python')
source=("https://github.com/Obsidian-Covenant/$_pkgname/archive/refs/tags/$pkgver.tar.gz")
sha512sums=('04ac476eeaf2f04a47cf6ead79ae0c7325e16a7ab478c976e9bd1f13e6be396724b78a5a9c58b18b7116d29a0d4550ad9865c4afacb162b9658af13d889a756e')

prepare(){
  cd "$_pkgname-$pkgver"

  sed -i 's|res/FullList|/usr/share/htexploit/res/FullList|' htexploit
}

package() {
  cd "$_pkgname-$pkgver"

  install -dm 755 "$pkgdir/usr/bin"
  install -dm 755 "$pkgdir/usr/share/$pkgname"

  cp -a * "$pkgdir/usr/share/$pkgname/"

  cat > "$pkgdir/usr/bin/$pkgname" << EOF
#!/bin/sh
exec python /usr/share/$pkgname/$pkgname "\$@"
EOF

  chmod +x "$pkgdir/usr/bin/$pkgname"
}


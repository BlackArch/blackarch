pkgname=dpeparser
pkgver=$(date +%Y%m%d)
pkgrel=1
pkgdesc="Default password enumeration project"
arch=('any')
url="http://www.toolswatch.org/dpe/"
license=('GPL')
groups=('blackarch' 'blackarch-analysis')
source=('http://www.toolswatch.org/dpe/dpeparser.py')
md5sums=('f802cc1d26190fdba0f4cfe5a7f1aaa8')

prepare() {
    python dpeparser.py -u
}

package() {
    instdir="$pkgdir/usr/share/dpeparser"
    bindir="$pkgdir/usr/bin"

    install -m755 -d "$bindir"
    install -m755 -d "$instdir"

    install -m755 dpeparser.py "$instdir/"
    install -m644 dpe_db.xml "$instdir/"

    sed -i 's#MydpeDB ="dpe_db.xml"#MydpeDB = "/usr/share/dpeparser/dpe_db.xml"#' "$instdir/dpeparser.py"

    cat > "$bindir/dpeparser" << EOF
#!/bin/bash

python /usr/share/dpeparser/dpeparser.py "\$@"

EOF

    chmod 755 "$bindir/dpeparser"

}



# This file is part of BlackArch Linux ( https://www.blackarch.org/ ).
# See COPYING for license details.

pkgname=rdp-cipher-checker
_pkgname=rdp-check-ciphers
_script=rdp_check_ciphers
pkgver=0.1
pkgrel=1
pkgdesc='Enumerate the encryption protocols supported by the server and the cipher strengths supported using native RDP encryption.'
arch=('any')
groups=('blackarch' 'blackarch-scanner' 'blackarch-networking'
        'blackarch-windows')
url='https://labs.f-secure.com/tools/rdp-cipher-checker/'
license=('BSD')
depends=('python2')
source=("https://labs.f-secure.com/assets/BlogFiles/$_pkgname.zip")
sha256sums=('408116b8fd893b1c90f08c92daaefcd533d0d8665a79a15a61f3c5aa2e34803a')

package() {
  
  install -dm 755 "$pkgdir/usr/bin"
  install -dm 755 "$pkgdir/usr/share/$pkgname"

  install -Dm 644 LICENSE "$pkgdir/usr/share/licenses/$pkgname/LICENSE"

  cp -a "$_script.py" "$pkgdir/usr/share/$pkgname/"

  cat > "$pkgdir/usr/bin/$pkgname" << EOF
#!/bin/sh
cd /usr/share/$pkgname
python2 "./$_script.py" "\$@"
EOF

  chmod a+x "$pkgdir/usr/bin/$pkgname"
}


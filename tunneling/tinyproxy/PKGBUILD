# Contributor: Andrea Zucchelli <zukka77@gmail.com>
# Contributor: Francesco Piccinno <stack.box@gmail.com>

pkgname=tinyproxy
pkgver=1.7.1
pkgrel=1
pkgdesc="lightweight HTTP proxy easy to run and configure"
arch=('i686' 'x86_64')
url="http://www.banu.com/tinyproxy/"
updateurl="https://www.banu.com/tinyproxy/download/=>tinyproxy-"
license=('GPL')
depends=('bash')
makedepends=('gcc' 'make' 'asciidoc')
backup=('etc/tinyproxy/tinyproxy.conf')
groups=('archpwn' 'archpwn-tunneling')
source=(http://www.banu.com/pub/tinyproxy/1.7/$pkgname-$pkgver.tar.gz
        tinyproxy-rc)
md5sums=('d860c527232e566575768f20b617c2dc'
         'bceb1aa1711d4092614813a96b815ecb')
build() {
  cd $srcdir/$pkgname-$pkgver
  ./configure --prefix=/usr --sysconfdir=/etc
  make || return 1
  make DESTDIR=$pkgdir install
  install -m 755 -D  $srcdir/tinyproxy-rc $pkgdir/etc/rc.d/tinyproxy
  #fix default group
  cat $pkgdir/etc/tinyproxy.conf |sed  's/Group nogroup/Group nobody/' > $pkgdir/etc/tinyproxy.conf
}
